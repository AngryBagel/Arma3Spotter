"use strict";angular.module("arma3SpotterApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","pascalprecht.translate"]),function(){function a(a,d){d.when("/",{templateUrl:"views/spotter.html",controller:"SpotterCtrl",controllerAs:"Spotter",activeTab:"spotter"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl",controllerAs:"Settings",activeTab:"settings"}).otherwise({redirectTo:"/"}),a.translations("en",c).translations("de",b).registerAvailableLanguageKeys(["en","de"],{en_US:"en",en_UK:"en",en_GB:"en",de_DE:"de",de_AT:"de",de_CH:"de"}).determinePreferredLanguage().fallbackLanguage("en")}angular.module("arma3SpotterApp").config(a),a.$inject=["$translateProvider","$routeProvider"];var b={SETTINGS:"Einstellungen",SETTINGS_MOD:"Mod",SETTING_WEAPON:"Waffe",SETTINGS_AMMO:"Munition",SETTINGS_SAVE:"Speichern",SPOTTER:"Spotter",SPOTTER_DISTANCE:"Entfernung",SPOTTER_ANGLE:"Winkel",SPOTTER_HEADWIND:"Gegenwind",SPOTTER_CROSSWIND:"Seitenwind",SPOTTER_TEMPERATURE:"Temperatur",SPOTTER_CALCULATE:"Berechnen",SPOTTER_HORIZONTAL:"Horizontal",SPOTTER_VERTICAL:"Vertikal"},c={SETTINGS:"Settings",SETTINGS_MOD:"Mod",SETTING_WEAPON:"Weapon",SETTINGS_AMMO:"Ammo",SETTINGS_SAVE:"Save",SPOTTER:"Spotter",SPOTTER_DISTANCE:"Distance",SPOTTER_ANGLE:"Angle",SPOTTER_HEADWIND:"Headwind",SPOTTER_CROSSWIND:"Crosswind",SPOTTER_TEMPERATURE:"Temperature",SPOTTER_CALCULATE:"Calculate",SPOTTER_HORIZONTAL:"Horizontal",SPOTTER_VERTICAL:"Vertical"}}(),function(){function a(a){function b(){var a=g.Data.getActiveAmmo(),b=Math.min(Math.max(parseInt(g.distance),1),3e3),c=Math.min(Math.max(parseInt(g.angle),0),360),d=Math.min(Math.max(parseFloat(g.headwind),-15),15),e=Math.min(Math.max(parseFloat(g.crosswind),-15),15),h=Math.min(Math.max(parseFloat(g.temperature),-50),50),i=f(a,b,c,d,e,45);if(i[0]<0)return g.resultHorizontal=0,void(g.resultVertical=0);var j=c,k=45;i=f(a,b,c,d,e,h,j);for(var l,m,n=i[0],o=i[1];Math.abs(n)>.1;)i=f(a,b,c,d,e,h,k),l=i[0],o=i[1],m=k-l*(k-j)/(l-n),j=k,k=m,n=l;try{var p=17.77777*(j-c);if(p=Math.round(10*p)/10,isNaN(p))throw"HairOnFire";g.resultVertical=p}catch(q){g.resultVertical=0}try{var r=Math.atan(o/b)*(180/Math.PI)*17.77777;if(r=Math.round(10*r)/10,isNaN(r))throw"HairOnFire";g.resultHorizontal=r}catch(q){g.resultHorizontal=0}}function c(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2))}function d(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2]]}function e(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function f(a,b,f,g,h,i,j){var k=a.initSpeed,l=a.airFriction,m=a.timeToLive,n=a.simulationStep,o=293.15/(273.15+i);j*=Math.PI/180,f*=Math.PI/180,g*=-1;var p=[Math.cos(f)*b,Math.sin(f)*b,0],q=[0,0,0],r=k*(((i+273.13)/288.13-1)/2.5+1-1),s=[Math.cos(j)*(k+r),Math.sin(j)*(k+r),0];n=Math.min(n,.001);for(var t=Math.floor(m/n),u=0;t>u;u++){var v=c(s);if(s[0]+=n*s[0]*v*l,s[1]+=n*(s[1]*v*l-9.81),s[2]+=n*s[2]*v*l,s=d(d(s,e(s,v*(o-1)*l*n)),e([g,0,h],-1*c(d(s,[g,0,h]))*l*n)),q=d(q,e(s,n)),q[0]>=p[0])break}return[q[1]-p[1],q[2]]}var g=this;g.angle=0,g.calculate=b,g.crosswind=0,g.Data=a,g.distance=1e3,g.headwind=0,g.temperature=30,g.resultHorizontal=0,g.resultVertical=0}angular.module("arma3SpotterApp").controller("SpotterCtrl",a),a.$inject=["Data"]}(),function(){function a(a,b,c){function d(){return a.getWeapons().then(function(a){return l.allWeapons=a,l.allWeapons.forEach(function(a){-1===l.mods.indexOf(a.mod)&&l.mods.push(a.mod)}),l.mods.sort(function(a,b){return a>b?1:-1}),h(),l.allWeapons})}function e(){c.setActiveWeapon(l.activeWeapon),c.setActiveAmmo(l.activeAmmo)}function f(){l.weapons=[],l.allWeapons.forEach(function(a){a.mod===l.activeMod&&l.weapons.push(a)}),l.weapons.sort(function(a,b){return a.name>b.name?1:-1}),i()}function g(){var a=b.getItem("activeAmmo");if(a&&""!==a){for(var c=!1,d=0;d<l.ammos.length;d++)if(l.ammos[d].name===a){l.activeAmmo=l.ammos[d],c=!0;break}c===!1&&(l.activeAmmo=l.ammos[0])}else l.activeAmmo=l.ammos[0];e()}function h(){var a=b.getItem("activeMod");if(a&&""!==a){var c=l.mods.indexOf(a);l.activeMod=c>=0&&l.mods.length>c?l.mods[c]:l.mods[0]}else l.activeMod=l.mods[0];f()}function i(){var a=b.getItem("activeWeapon");if(a&&""!==a){for(var c=!1,d=0;d<l.weapons.length;d++)if(l.weapons[d].name===a){l.activeWeapon=l.weapons[d],c=!0;break}c===!1&&(l.activeWeapon=l.weapons[0])}else l.activeWeapon=l.weapons[0];j()}function j(){l.ammos=l.activeWeapon.magazines,l.ammos.sort(function(a,b){return a.name>b.name?1:-1}),g()}function k(){b.setItem("activeMod",l.activeMod),b.setItem("activeWeapon",l.activeWeapon.name),b.setItem("activeAmmo",l.activeAmmo.name)}var l=this;l.activeAmmo="",l.activeMod="",l.activeWeapon="",l.allWeapons=[],l.ammoChanged=e,l.ammos=[],l.modChanged=f,l.mods=[],l.saveConfig=k,l.weaponChanged=j,l.weapons=[],d()}angular.module("arma3SpotterApp").controller("SettingsCtrl",a),a.$inject=["DataService","StorageService","Data"]}(),function(){function a(a,b){function c(){return a.get("data/weapons.json").then(d).catch(e)}function d(a){return a.data}function e(a){b.logError("XHR failed for getWeapons."+a.data)}return{getWeapons:c}}angular.module("arma3SpotterApp").factory("DataService",a),a.$inject=["$http","logger"]}(),function(){function a(){return{logError:function(a){console.log(a)}}}angular.module("arma3SpotterApp").service("logger",a)}(),function(){function a(){function a(a){if(!a||""===a)throw new Error("StorageService.getItem: Key is empty!");var b=localStorage.getItem(a);if(b&&""!==b){var c=JSON.parse(b);return c.item}return null}function b(a,b){if(!a||""===a)throw new Error("StorageService.setItem: Key is empty!");if(!b)throw new Error("StorageService.setItem: Item is null!");"object"==typeof b?localStorage.setItem(a,JSON.stringify({type:"object",item:b})):"string"==typeof b&&localStorage.setItem(a,JSON.stringify({type:"string",item:b}))}return{getItem:a,setItem:b}}angular.module("arma3SpotterApp").factory("StorageService",a)}(),function(){angular.module("arma3SpotterApp").factory("Data",function(){function a(){return e.activeAmmo}function b(){return e.activeWeapon}function c(a){a&&"object"==typeof a&&(e.activeAmmo=a)}function d(a){a&&"object"==typeof a&&(e.activeWeapon=a)}var e={activeWeapon:null,activeAmmo:null};return{getActiveAmmo:a,getActiveWeapon:b,setActiveAmmo:c,setActiveWeapon:d}})}(),function(){function a(a){var b=this;b.route=a}angular.module("arma3SpotterApp").controller("HeaderCtrl",a),a.$inject=["$route"]}();