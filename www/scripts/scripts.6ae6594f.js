"use strict";angular.module("arma3SpotterApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]),function(){function a(a,b,c,d){function e(){return b.getWeapons().then(function(a){return m.allWeapons=a,m.allWeapons.forEach(function(a){-1===m.mods.indexOf(a.mod)&&m.mods.push(a.mod)}),m.mods.sort(function(a,b){return a>b?1:-1}),i(),m.allWeapons})}function f(){d.setActiveWeapon(m.activeWeapon),d.setActiveAmmo(m.activeAmmo)}function g(){m.weapons=[],m.allWeapons.forEach(function(a){a.mod===m.activeMod&&m.weapons.push(a)}),m.weapons.sort(function(a,b){return a.name>b.name?1:-1}),j()}function h(){var a=c.getItem("activeAmmo");if(a&&""!==a){for(var b=!1,d=0;d<m.ammos.length;d++)if(m.ammos[d].name===a){m.activeAmmo=m.ammos[d],b=!0;break}b===!1&&(m.activeAmmo=m.ammos[0])}else m.activeAmmo=m.ammos[0];f()}function i(){var a=c.getItem("activeMod");if(a&&""!==a){var b=m.mods.indexOf(a);m.activeMod=b>=0&&m.mods.length>b?m.mods[b]:m.mods[0]}else m.activeMod=m.mods[0];g()}function j(){var a=c.getItem("activeWeapon");if(a&&""!==a){for(var b=!1,d=0;d<m.weapons.length;d++)if(m.weapons[d].name===a){m.activeWeapon=m.weapons[d],b=!0;break}b===!1&&(m.activeWeapon=m.weapons[0])}else m.activeWeapon=m.weapons[0];k()}function k(){m.ammos=m.activeWeapon.magazines,m.ammos.sort(function(a,b){return a.name>b.name?1:-1}),h()}function l(){c.setItem("activeMod",m.activeMod),c.setItem("activeWeapon",m.activeWeapon.name),c.setItem("activeAmmo",m.activeAmmo.name)}var m=this;m.activeAmmo="",m.activeMod="",m.activeWeapon="",m.allWeapons=[],m.ammoChanged=f,m.ammos=[],m.modChanged=g,m.mods=[],m.saveConfig=l,m.weaponChanged=k,m.weapons=[],e()}angular.module("arma3SpotterApp").controller("SettingsCtrl",a),a.$inject=["$scope","DataService","StorageService","Data"]}(),function(){function a(a,b){function c(){var a=e.Data.getActiveAmmo(),b=parseInt(e.distance),c=parseInt(e.angle),f=parseInt(e.headwind),g=parseInt(e.crosswind),h=d(a,b,c,f,g,45);if(h[0]<0)return e.resultHorizontal=0,void(e.resultVertical=0);var i=c,j=45;h=d(a,b,c,f,g,i);for(var k,l,m=h[0],n=h[1];Math.abs(m)>.1;)h=d(a,b,c,f,g,j),k=h[0],n=h[1],l=j-k*(j-i)/(k-m),i=j,j=l,m=k;try{var o=17.77777*(i-c);if(o=Math.round(10*o)/10,isNaN(o))throw"HairOnFire";e.resultVertical=o}catch(p){e.resultVertical=0}try{var q=Math.atan(n/b)*(180/Math.PI)*17.77777;if(q=Math.round(10*q)/10,isNaN(q))throw"HairOnFire";e.resultHorizontal=q}catch(p){e.resultHorizontal=0}}function d(a,b,c,d,e,f){var g=a.initSpeed,h=a.airFriction,i=a.timeToLive,j=a.simulationStep;f*=Math.PI/180,c*=Math.PI/180;for(var k=[Math.cos(c)*b,Math.sin(c)*b],l=[0,0,0],m=[Math.cos(f)*g,Math.sin(f)*g,0],n=Math.floor(i/j),o=0;n>o;o++){var p=Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2)+Math.pow(m[2],2));if(m[0]+=j*m[0]*p*h+.7*j*d,m[1]+=j*(m[1]*p*h-9.81),m[2]+=j*m[2]*p*h+.7*j*e,l[0]+=m[0]*j,l[1]+=m[1]*j,l[2]+=m[2]*j,l[0]>=k[0])break}return[l[1]-k[1],l[2]]}var e=this;e.angle="",e.calculate=c,e.crosswind="",e.Data=b,e.distance="",e.headwind="",e.resultHorizontal=0,e.resultVertical=0}angular.module("arma3SpotterApp").controller("CalculationCtrl",a),a.$inject=["$scope","Data"]}(),function(){function a(a,b){function c(){return a.get("data/weapons.json").then(d).catch(e)}function d(a){return a.data}function e(a){b.logError("XHR failed for getWeapons."+a.data)}return{getWeapons:c}}angular.module("arma3SpotterApp").factory("DataService",a),a.$inject=["$http","logger"]}(),function(){function a(){return{logError:function(a){console.log(a)}}}angular.module("arma3SpotterApp").service("logger",a)}(),angular.module("arma3SpotterApp").service("StorageService",function(){}),function(){function a(){function a(a){if(!a||""===a)throw new Error("StorageService.getItem: Key is empty!");var b=localStorage.getItem(a);if(b&&""!==b){var c=JSON.parse(b);return c.item}return null}function b(a,b){if(!a||""===a)throw new Error("StorageService.setItem: Key is empty!");if(!b)throw new Error("StorageService.setItem: Item is null!");"object"==typeof b?localStorage.setItem(a,JSON.stringify({type:"object",item:b})):"string"==typeof b&&localStorage.setItem(a,JSON.stringify({type:"string",item:b}))}return{getItem:a,setItem:b}}angular.module("arma3SpotterApp").factory("StorageService",a)}(),function(){angular.module("arma3SpotterApp").factory("Data",function(){function a(){return e.activeAmmo}function b(){return e.activeWeapon}function c(a){a&&"object"==typeof a&&(e.activeAmmo=a)}function d(a){a&&"object"==typeof a&&(e.activeWeapon=a)}var e={activeWeapon:null,activeAmmo:null};return{getActiveAmmo:a,getActiveWeapon:b,setActiveAmmo:c,setActiveWeapon:d}})}();